-----Explaination-----

#Extract Sharepoint Pages and Content Links
#CSV should contain URL of Sharepoint page(s) and Site Title(s)#
#The script must be ran under an account with Sharepoint owner rights#

-----Example------

$intranet = import-csv 'C:\temp\SharepointSites.csv' 
$username = $env:USERNAME
$PWord = ConvertTo-SecureString -String #removed after use# -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $username,$PWord #removed after use#

foreach ($page in $intranet){

$webUrl = $page.URL
$title = $page.Name
$cred = $Credential

$content = invoke-webrequest $webUrl -Credential $cred
$content.Links | Select outertext,href | out-file #path#\$title.txt -verbose

} 

-----End-----
