#Installing Dell Driver Remotely

#Create a variable for CSV import
$importcsv = Import-CSV <source>

#Create a Script Block to run job with CSV
foreach ($object in $importcsv){
  
  #create sub-variable
  $hostname = $object.name
    ##$object.name --> "name" is column w/ header "name" with values beneath it being workstation hostname(s)
    
  #Create a file copy statement, make sure the destination folder exists
  #Alternatively, you could use robocopy; however, make sure you're not copying data you will not use - save time
  
  Example--
      New-Item -ItemType Directory -Path <destination>
      Copy-Item -Path <source> -destination <destination>
  #Note: "<destination>" can be '\\hostname\root\<new>' or '\\hostname\root\<new>\<new> -- the new directory and sub-directory/ies will generate
  
  #Now we can invoke a command to a remote workstation
  Example--
      Invoke-Command -ComputerName $hostname -ScriptBlock {
        Start-Process '<source>' -ArgumentList "/f","/s" -Wait
        }
  #Note: "<source>" is the workstation/server you're running the job from, the installer should share the same path as the client path
  Example--
      #If source path is 'C:\softwares\installer.exe', then desitination path was copied to 
      should be '\\hostname\c$\softwares\installer.exe', then the install line should be
       Start-Process C:\softwares\installer.exe
       
  #As an end note, you can also add the "-AsJob" option to assign it as a background job to the client machine
  
  --Full Example--
  
  $importCSV = Import-CSV \\source\file.csv
  
  foreach ($object in $importCSV){
    $hostname = $object.name
    New-Item -ItemType Directory -Path '\\$hostname\c$\softwares'
    Copy-Item -Path 'C:\softwares\installer.exe' -destination '\\$hostname\c$\softwares\installer.exe'
    
    Invoke-Command -ComputerName $hostname -ScriptBlock{
      Start-Process 'C:\softwares\installer.exe' -ArgumentList "/f","/s" -Wait
        } -AsJob
      }
      
  --Alternative Example--   
  
  #This example adds in ROBOCOPY function & Progress Bar UI for the install process

  $PC = Import-Csv "\\path\file.csv"
  $source = "\\path\folder"

  foreach ($import in $PC) {

    $hostname = $import.name

    robocopy $source /r:0 /w:0 "\\$hostname\c$\Dell\3050" /mir

  Invoke-Command -ComputerName $hostname -ScriptBlock {
        for ($percent=0; $percent -le 100; $percent++)
    {
        Write-Progress -Activity "Installing Drivers Set 1" -Status "Progress.." -PercentComplete $percent
        Start-Process "C:\softwares\installer.exe" -ArgumentList "/f","/s" -Wait}
    }

  #Note: You can also run the same script above for updating BIOS, just change the '-ArgumentList' to "/s","/f","/r"
  "/s" = Silent Switch
  "/f" = ignores errors and forces installer to proceed
  "/r" = configures the installer to automatically restart to complete BIOS flash update
   
